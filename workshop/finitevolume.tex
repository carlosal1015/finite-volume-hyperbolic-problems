\chapter{Esquemas de volúmenes finitos para sistemas no lineales}

Considere un problema de valor inicial frontera para un sistema
hiperbólico de leyes de conservación.
\begin{equation*}
	\diffp{\symbf{u}}{t}+
	\diffp*{\symbf{f}\left(\symbf{u}\right)}{x}=
	\symbf{s}\left(\symbf{u}\right).
	\symbf{u}\left(x,0\right)
	\symbf{u}\left(a,t\right)=
	\symbf{u}\left(b,t\right).
\end{equation*}
La forma integral de las leyes de conservación es
\begin{equation*}
	\int_{x_{l}}^{x_{r}}
	\symbf{u}\left(x,t_{2}\right)\dl x=
	\int_{x_{l}}^{x_{r}}
	\symbf{u}\left(x,t_{1}\right)\dl x+
	\int_{t_{1}}^{t_{2}}
	\symbf{f}\left(\symbf{u}\left(x_{l},t\right)\right)\dl t-
	\int_{t_{1}}^{t_{2}}
	\symbf{f}\left(\symbf{u}\left(x_{r},t\right)\right)\dl t+
	\int_{t_{1}}^{t_{2}}
	\int_{x_{l}}^{x_{r}}
	\symbf{s}\left(\symbf{u}\left(x,t\right)\right)\dl x\dl t.
\end{equation*}

\begin{equation*}
	V^{n}_{i}=
	\left[x_{i-\frac{1}{2}},x_{i+\frac{1}{2}}\right]\times
	\left[t_{n},t_{n+1}\right]
\end{equation*}
con $\Delta x=x_{i+\frac{1}{2}}-x_{i-\frac{1}{2}}$ y $\Delta t=t_{n+1}-t_{n}$.

\begin{equation*}
	\symbf{u}^{n+1}_{i}=
	\symbf{u}^{n}_{i}-
	\frac{\Delta t}{\Delta x}
	\left(\symbf{f}_{i+\frac{1}{2}}-\symbf{f}_{i-\frac{1}{2}}\right)+
	\Delta t\symbf{s}_{i}.
\end{equation*}

\begin{align*}
	\symbf{u}^{n}_{i}             & =
	\frac{1}{\Delta x}
	\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}
	\symbf{u}\left(x,t_{n}\right)\dl x.                                   \\
	\symbf{f}^{n}_{i+\frac{1}{2}} & =
	\frac{1}{\Delta t}
	\int_{t_{n}}^{t_{n+1}}
	\symbf{f}\left(\symbf{u}\left(x_{i+\frac{1}{2}},t\right)\right)\dl t. \\
	\symbf{s}_{i}                 & =
	\frac{1}{\Delta t\Delta x}
	\int_{t_{n}}^{t_{n+1}}
	\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}
	\symbf{s}\left(\symbf{u}\left(x,t\right)\right)\dl x\dl t.            \\
\end{align*}

\begin{equation*}
	s_{i}=
	\frac{1}{\Delta x\Delta t}
	\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}
	\int_{0}^{\Delta t}
	\beta
	u\left(x,t\right)\dl x\dl t.
\end{equation*}

\begin{equation*}
	s_{i}=
	\frac{1}{2}
	c\beta u^{n}
\end{equation*}

Considere el problema de Cauchy~\eqref{eq:cauchysystemofconservationlaw}
donde~\eqref{eq:systemofconservationlaw} es hiperbólico.
Consideremos $C_{j}=\left[x_{j-\frac{1}{2}},x_{j+\frac{1}{2}}\right]\subset\mathbb{R}$
\begin{equation*}
	\symbf{v}^{n}_{j}\approx
	\frac{1}{\left|C_{j}\right|}
	\int_{C_{j}}
	\symbf{u}\left(x,t_{n}\right)\dl{\symbf{x}}.
\end{equation*}

\begin{equation*}
	\diff{}{t}
	\int_{C_{j}}
	\symbf{u}\left(x,t\right)\dl x+
	\symbf{f}\left(\symbf{u}\left(x_{j+\frac{1}{2}},t\right)\right)-
	\symbf{f}\left(\symbf{u}\left(x_{j-\frac{1}{2}},t\right)\right)=
	\symbf{0}.
\end{equation*}

\begin{equation*}
	\diff{}{t}\symbf{v}_{j}+
	\frac{1}{\Delta x}
	\left(
	\symbf{g}_{j+\frac{1}{2}}\left(t\right)-
	\symbf{g}_{j-\frac{1}{2}}\left(t\right)
	\right)=
	\symbf{0}.
\end{equation*}

\begin{equation*}
	\symbf{v}^{n+1}_{j}=
	\symbf{H}\left(\symbf{v}^{n}_{j-k},\dotsc,\symbf{v}^{n}_{j+k}\right).
\end{equation*}

\begin{equation*}
	\symbf{g}_{j+\frac{1}{2}}\left(t\right)=
	\symbf{g}\left(\symbf{v}\right).
\end{equation*}

% \section{Método de Godunov}

% \begin{equation*}
% 	\symbf{w}\left(x,t\right)=
% 	\symbf{w}_{R}
% 	\left(\frac{x}{t};\symbf{u}_{L},\symbf{u}_{R}\right).
% \end{equation*}

% \section{Método de Roe}

% \section{Método de Rusanov}

\section{Métodos de pasos fraccionarios}

Para resolver un sistema de leyes de conservación con un término fuente empleamos el método del paso fraccionario~\cite{Leveque2002}
\begin{equation}
	\left\{
	\begin{aligned}
		\diffp{\symbf{u}}{t}+
		\diffp*{f\left(\symbf{u}\right)}{x} & =
		\symbf{0}.                              \\
		\diff{\symbf{u}}{t}                 & =
		\symbf{s}\left(\symbf{u}\right).
	\end{aligned}
	\right.
\end{equation}

\begin{description}
	\item[\color{DarkBlue}Método Upwind]

	      \begin{equation*}
		      \frac{\symbf{u}^{n+1}_{i}-\symbf{u}^{n}_{i}}{\Delta t}=
		      -\frac{\symbf{f}^{n}_{i}-\symbf{f}^{n}_{i-1}}{\Delta x}\implies
		      \symbf{u}^{n+1}_{i}-\symbf{u}^{n}_{i}=
		      -\frac{\Delta t}{\Delta x}
					\left(\symbf{f}^{n}_{i}-\symbf{f}^{n}_{i-1}\right).
	      \end{equation*}

	      \begin{equation*}
		      \boxed{
			      \symbf{u}^{\ast}_{i}=
			      \symbf{u}^{n}_{i}-\frac{\Delta t}{\Delta x}\left(\symbf{f}^{n}_{i}-\symbf{f}^{n}_{i-1}\right).
		      }
	      \end{equation*}
	\item[\color{DarkBlue}Euler hacia adelante]

	      \begin{equation*}
		      \frac{\symbf{u}^{n+1}_{i}-\symbf{u}^{n}_{i}}{\Delta t}=
		      \symbf{s}\left(\symbf{u}^{n+1}_{i}\right)\implies
		      \symbf{u}^{n+1}_{i}=\symbf{u}^{\ast}_{i}+\Delta t
		      \symbf{s}\left(\symbf{u}^{\ast}_{i}\right).
	      \end{equation*}
\end{description}
